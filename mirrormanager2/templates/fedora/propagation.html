{% extends "master_noauth.html" %}

{% block title %}Propagation{% endblock %}

{%block tag %}propagation{% endblock %}

{% block content %}
<h1>Propagation</h1>

{%- if config['SHOW_PROPAGATION'] -%}
{%- if prefix == "oops" %}
<h3>Ooooops, some file was somehow (or somewhere) not found. Move along!</h3>
{%- else %}

This diagram shows how many mirrors for the {{prefix}} branch have a
repomd.xml file which is the same (respectively one day older, two days older or
much older) version as on the master mirror.

{%- if repos %}
<br />The same diagram is als available for the branches:
<ul>
  {%- for repo in repos -%}
  {%- if repo.prefix != prefix %}
  <li>
    <a href="{{url_for('base.propagation', prefix=repo.prefix)}}"
      >{{ repo.prefix }}</a
    >
  </li>
  {%- endif -%}
  {%- endfor -%}
</ul>

{%- endif -%}

<canvas id="chart"></canvas>

{%- endif -%}
{% else -%}
Actually, this is disabled and you should not be here.
Go away!
{%- endif -%}
{% endblock %}


{% block jscripts %}
{{ super() }}
<script src="{{ url_for('static', filename='chart.js') }}"></script>
<script>
  const canvas = document.getElementById('chart');

  new Chart(canvas, {
    type: 'bar',
    data: {
      labels: {{ labels | tojson }},
      datasets: {{ datasets | tojson }},
    },
    options: {
      scales: {
        x: {
          stacked: true
        },
        y: {
          stacked: true,
          beginAtZero: true
        }
      }
    }
  });
</script>
{% endblock %}
